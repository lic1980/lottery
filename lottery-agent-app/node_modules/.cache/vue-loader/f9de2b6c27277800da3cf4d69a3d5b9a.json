{"remainingRequest":"C:\\workspace\\lottery-app\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\workspace\\lottery-app\\src\\components\\Lottery.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\workspace\\lottery-app\\src\\components\\Lottery.vue","mtime":1599026053890},{"path":"C:\\workspace\\lottery-app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\workspace\\lottery-app\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\workspace\\lottery-app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\workspace\\lottery-app\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICdheGlvcycKZXhwb3J0IGRlZmF1bHQgewogICAgZGF0YSAoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgY3VycmVudDogbnVsbCwKICAgICAgICAgICAgY3VzdG9tZXI6IHsgImlkIjogIiIsICJkZXBvc2l0IjogMCB9LAogICAgICAgICAgICBsb3R0ZXJ5Um91bmQ6IHsibG90dGVyeSI6IHsibmFtZSI6IiJ9fSwKICAgICAgICAgICAgb3B0aW9uc0J5SXRlbUlkczogbmV3IE1hcCgpLAogICAgICAgICAgICBpdGVtQnlJdGVtSWRzOiBuZXcgTWFwKCksCiAgICAgICAgICAgIG9wdGlvbnNTZWxlY3RlZDogW10KICAgICAgICB9CiAgICB9LAogICAgbWV0aG9kczogewogICAgICAgIHNlbGVjdE9wdGlvbjogZnVuY3Rpb24gKG9wdGlvbikgewogICAgICAgICAgICB2YXIgcG9zaXRpb24gPSB0aGlzLm9wdGlvbnNTZWxlY3RlZC5pbmRleE9mKG9wdGlvbik7CiAgICAgICAgICAgIGlmIChwb3NpdGlvbiA8IDApIHsKICAgICAgICAgICAgICAgIHRoaXMub3B0aW9uc1NlbGVjdGVkLnB1c2gob3B0aW9uKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHRoaXMub3B0aW9uc1NlbGVjdGVkLnNwbGljZShwb3NpdGlvbiwgMSk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHN1Ym1pdDogZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHZhciBvcHRpb25OdW1CeUl0ZW1JZHMgPSBuZXcgTWFwKCk7CiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5vcHRpb25zU2VsZWN0ZWQubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIHZhciBvcHRpb24gPSB0aGlzLm9wdGlvbnNTZWxlY3RlZFtpXTsKICAgICAgICAgICAgICAgIHZhciBpdGVtSWQgPSBvcHRpb24uaXRlbS5pZDsKICAgICAgICAgICAgICAgIGlmICggb3B0aW9uTnVtQnlJdGVtSWRzLmhhcyhpdGVtSWQpKSB7CiAgICAgICAgICAgICAgICAgICAgb3B0aW9uTnVtQnlJdGVtSWRzLnNldChpdGVtSWQsIG9wdGlvbk51bUJ5SXRlbUlkcy5nZXQoaXRlbUlkKSArIDEpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBvcHRpb25OdW1CeUl0ZW1JZHMuc2V0KGl0ZW1JZCwgMSApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZvciAobGV0IFtpdGVtSWQsIGl0ZW1CeUl0ZW1dIG9mIHRoaXMuaXRlbUJ5SXRlbUlkcykgewogICAgICAgICAgICAgICAgdmFyIG51bSA9IG9wdGlvbk51bUJ5SXRlbUlkcy5nZXQoaXRlbUlkKTsKICAgICAgICAgICAgICAgIGlmIChudW0gPCBpdGVtQnlJdGVtLm1pbk9wdGlvbk51bSkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoJ+ivt+e7p+e7remAieaLqScgKyBpdGVtQnlJdGVtLm5hbWUpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnNTZWxlY3RlZC5sZW5ndGggPCB0aGlzLmxvdHRlcnlSb3VuZC5sb3R0ZXJ5Lm1pbk9wdGlvbk51bSkgewogICAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSgn6K+357un57ut6YCJ5oupJyk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBsZXQgdG90YWxGZWUgPSAyOwogICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm9wdGlvbnNTZWxlY3RlZC5sZW5ndGggLTEgLSB0aGlzLmxvdHRlcnlSb3VuZC5sb3R0ZXJ5Lm1pbk9wdGlvbk51bTsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgdG90YWxGZWUgPSB0b3RhbEZlZSAqIHRvdGFsRmVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSgn5YWx6Iqx6LS5J3RvdGFsRmVlKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0sCiAgICBtb3VudGVkICgpIHsKICAgICAgICBheGlvcwogICAgICAgICAgICAuZ2V0KCdodHRwOi8vbG9jYWxob3N0OjgwODAvYXBpL3YxL2N1c3RvbWVycy8xJykKICAgICAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gKHRoaXMuY3VzdG9tZXIgPSByZXNwb25zZS5kYXRhKSkKICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgeyAKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgYXhpb3MKICAgICAgICAgICAgLmdldCgnaHR0cDovL2xvY2FsaG9zdDo4MDgwL2FwaS92MS9sb3R0ZXJpZXMvMS9yb3VuZHM/c3RhdHVzPWFjdGl2ZScpCiAgICAgICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5jb250ZW50Lmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb3R0ZXJ5Um91bmQgPSByZXNwb25zZS5kYXRhLmNvbnRlbnRbMF07CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgeyAKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgYXhpb3MKICAgICAgICAgICAgLmdldCgnaHR0cDovL2xvY2FsaG9zdDo4MDgwL2FwaS92MS9sb3R0ZXJpZXMvMS9vcHRpb25zJykKICAgICAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgICAgICAgICAgICAgIHZhciBvcHRpb25zID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICAgICAgICAgICAgICB2YXIgb3B0aW9uc0J5aXRlbSA9IFtdOwogICAgICAgICAgICAgICAgICAgIHZhciBvcHRpb25zQnlJdGVtSWRzID0gbmV3IE1hcCgpOwogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb3B0aW9ucy5sZW5ndGg7IGkgKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9wdGlvbiA9IG9wdGlvbnNbaV07CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpdGVtID0gb3B0aW9uLml0ZW07CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcHRpb25zQnlJdGVtSWRzLmhhcyhpdGVtLmlkKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uc0J5SXRlbUlkcy5nZXQoaXRlbS5pZCkucHVzaChvcHRpb24pOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uc0J5aXRlbSA9IFtdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uc0J5aXRlbS5wdXNoKG9wdGlvbik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zQnlJdGVtSWRzLnNldChpdGVtLmlkLCBvcHRpb25zQnlpdGVtKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLml0ZW1CeUl0ZW1JZHMuc2V0KGl0ZW0uaWQsIGl0ZW0pOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHRoaXMub3B0aW9uc0J5SXRlbUlkcyA9IG9wdGlvbnNCeUl0ZW1JZHM7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7IAogICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpOwogICAgICAgICAgICB9KTsKICAgIH0KfQo="},{"version":3,"sources":["Lottery.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Lottery.vue","sourceRoot":"src/components","sourcesContent":["<template>\n    <div>\n        <div>\n            <div>账户余额：{{ customer.deposit }}</div>\n        </div>\n        <div>\n            <div>\n                <div>\n                    名称：{{ lotteryRound.lottery.name }}\n                </div>\n                <div>\n                    开奖日期：{{ lotteryRound.openingTime }}\n                </div>\n                <div style=\"overflow:hidden\" v-for=\"(optionsItemId, itemIndex) in optionsByItemIds.entries()\" v-bind:key=\"itemIndex\">\n                    <div></div>\n                    <div style=\"float:left;\">\n                        {{ itemByItemIds.get(optionsItemId[0]).name }}\n                    </div>\n                    <div style=\"float:left;\" v-for=\"(option, optionIndex) of optionsItemId[1]\" v-bind:key=\"optionIndex\">\n                        <el-button v-on:click=\"selectOption(option)\" v-bind:class=\"optionsSelected.includes(option)?'select': 'unselect' \" size=\"small\" circle>\n                            <div style=\"width: 16px;\">\n                            {{ option.text }}\n                            </div>\n                        </el-button>\n                    </div>\n                </div>\n                <div>\n                    <div>\n                        <el-button v-on:click=\"submit()\" size=\"small\">\n                            确定\n                        </el-button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\nimport axios from 'axios'\nexport default {\n    data () {\n        return {\n            current: null,\n            customer: { \"id\": \"\", \"deposit\": 0 },\n            lotteryRound: {\"lottery\": {\"name\":\"\"}},\n            optionsByItemIds: new Map(),\n            itemByItemIds: new Map(),\n            optionsSelected: []\n        }\n    },\n    methods: {\n        selectOption: function (option) {\n            var position = this.optionsSelected.indexOf(option);\n            if (position < 0) {\n                this.optionsSelected.push(option);\n            } else {\n                this.optionsSelected.splice(position, 1);\n            }\n        },\n        submit: function() {\n            var optionNumByItemIds = new Map();\n            for (var i = 0; i < this.optionsSelected.length; i++) {\n                var option = this.optionsSelected[i];\n                var itemId = option.item.id;\n                if ( optionNumByItemIds.has(itemId)) {\n                    optionNumByItemIds.set(itemId, optionNumByItemIds.get(itemId) + 1);\n                } else {\n                    optionNumByItemIds.set(itemId, 1 );\n                }\n            }\n            for (let [itemId, itemByItem] of this.itemByItemIds) {\n                var num = optionNumByItemIds.get(itemId);\n                if (num < itemByItem.minOptionNum) {\n                    this.$message('请继续选择' + itemByItem.name);\n                }\n            }\n            if (this.optionsSelected.length < this.lotteryRound.lottery.minOptionNum) {\n                this.$message('请继续选择');\n            } else {\n                let totalFee = 2;\n                for (let i = 0; i < this.optionsSelected.length -1 - this.lotteryRound.lottery.minOptionNum; i++) {\n                    totalFee = totalFee * totalFee;\n                }\n                this.$message('共花费'totalFee);\n            }\n        }\n    },\n    mounted () {\n        axios\n            .get('http://localhost:8080/api/v1/customers/1')\n            .then(response => (this.customer = response.data))\n            .catch(function (error) { \n                console.log(error);\n            });\n        axios\n            .get('http://localhost:8080/api/v1/lotteries/1/rounds?status=active')\n            .then(response => {\n                    if (response.data.content.length > 0) {\n                        this.lotteryRound = response.data.content[0];\n                    }\n                })\n            .catch(function (error) { \n                console.log(error);\n            });\n        axios\n            .get('http://localhost:8080/api/v1/lotteries/1/options')\n            .then(response => {\n                    var options = response.data;\n                    var optionsByitem = [];\n                    var optionsByItemIds = new Map();\n                    for (var i = 0; i < options.length; i ++) {\n                        var option = options[i];\n                        var item = option.item;\n                        if (optionsByItemIds.has(item.id)) {\n                            optionsByItemIds.get(item.id).push(option);\n                        } else {\n                            optionsByitem = [];\n                            optionsByitem.push(option);\n                            optionsByItemIds.set(item.id, optionsByitem);\n\n                            this.itemByItemIds.set(item.id, item);\n                        }\n                    }\n                    this.optionsByItemIds = optionsByItemIds;\n                })\n            .catch(function (error) { \n                console.log(error);\n            });\n    }\n}\n</script>\n\n<style>\n.select{\n    background-color: red;\n    color:white;\n}\n.select:hover{\n    background-color: red;\n    color:white;\n}\n.select:focus{\n    background-color: red;\n    color:white;\n}\n.unselect{\n    background-color: white;\n    border-color: #DCDFE6;\n}\n.unselect:hover{\n    background-color: white;\n    border-color: #DCDFE6;\n    color:black;\n}\n.unselect:focus{\n    background-color: white;\n    border-color: #DCDFE6;\n    color:black;\n}\n</style>"]}]}